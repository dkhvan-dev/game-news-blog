<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head th:insert="~{/toInsert/head.html}">
    <title>Admin Panel</title>
</head>
<body>

    <div th:insert="~{/toInsert/preloader.html}"></div>

    <!-- Header section -->
    <header th:insert="~{/toInsert/header.html}">
    </header>
    <!-- Header section end -->

    <main class="d-flex flex-column">
        <!-- ADDNEWS ALERT -->
        <div class="alert alert-danger" role="alert" th:if="${param.errorAddNews}">
            Couldn't add a news item. Check the correctness of the entered data!
        </div>
        <!-- ADDGAME ALERT -->
        <div class="alert alert-danger" role="alert" th:if="${param.errorAddGame}">
            Couldn't add a game item. Check the correctness of the entered data!
        </div>
        <!-- APPLICATION FORM BLOGGER ALERT -->
        <div class="alert alert-danger" role="alert" th:if="${param.errorNotFoundApplication}">
            Application not found!
        </div>
        <!-- FEEDBACK ALERT -->
        <div class="alert alert-danger" role="alert" th:if="${param.errorFeedbackNotFound}">
            Feedback not found!
        </div>

        <!-- News Collapse -->
        <div class="d-flex">
            <div class="admin-collapse">
                <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#newsCollapseAdmin" aria-expanded="false" aria-controls="collapseExample">
                    News
                </button>
            </div>
            <div class="collapse admin-collapse__show" id="newsCollapseAdmin">
                <div class="card card-body">
                    <!-- Button addNews modal -->
                    <div>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addNewsModal">
                            Add news
                        </button>
                    </div>

                    <!-- AddNews Modal -->
                    <div class="modal fade" id="addNewsModal" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog">
                            <form class="form-control" th:action="@{'/addNews'}" method="post">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Add News</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body d-flex flex-column">
                                        <label class="form-label mt-3"> Title:
                                            <input type="text" class="form-control" name="newsTitle" required>
                                        </label>
                                        <label class="form-label mt-3">Description:
                                            <textarea class="form-control" name="newsDescription"></textarea>
                                        </label>
                                        <select class="form-select mt-3" name="game">
                                            <option th:each="game : ${allGames}" th:text="${game.gameName}" th:value="${game.gameId}"></option>
                                        </select>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        <button class="btn btn-primary">Add news</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- ALL NEWS TABLE -->
                    <table class="table">
                        <thead>
                        <tr>
                            <th scope="col">ID</th>
                            <th scope="col">Title</th>
                            <th scope="col">Create date</th>
                            <th scope="col">Game</th>
                            <th scope="col">Details</th>
                            <th scope="col">Delete</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="news : ${allNews}">
                            <th scope="row" th:text="${news.newsId}"></th>
                            <td th:text="${news.newsTitle}"></td>
                            <td th:text="${news.newsCreateDate}"></td>
                            <td th:text="${news.getGame().gameName}"></td>
                            <td><a class="btn btn-primary" th:href="@{'/detailsNewsAdmin/' + ${news.newsId}}">Details</a></td>
                            <td>
                                <button type="button" class="btn btn-danger deleteNewsModal" data-bs-toggle="modal" data-bs-target="#deleteNewsAdmin"
                                        th:data-id="${news.newsId}">
                                    Delete
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <!-- Delete News Modal -->
                    <form th:action="@{'/deleteNewsAdmin'}" method="post">
                        <div class="modal fade" id="deleteNewsAdmin" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Delete News</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        Are you sure?
                                        <input type="hidden" name="newsId" value="" id="newsId">
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                        <button class="btn btn-danger">Delete News</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>

                </div>
            </div>
        </div>
        <!-- Game Collapse -->
        <div class="d-flex">
            <div class="admin-collapse">
                <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#gamesCollapseAdmin" aria-expanded="false" aria-controls="collapseExample">
                    Games
                </button>
            </div>
            <div class="collapse admin-collapse__show" id="gamesCollapseAdmin">
                <div class="card card-body">
                    <!-- Button addGame modal -->
                    <div>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addGameModal">
                            Add game
                        </button>
                    </div>

                    <!-- AddGame Modal -->
                    <div class="modal fade" id="addGameModal" tabindex="-1" aria-hidden="true">
                        <form class="form-control" th:action="@{'/addGame'}" method="post" enctype="multipart/form-data">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Add game</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="mt-3">
                                            <label>Name:
                                                <input type="text" class="form-control" name="gameName" required>
                                            </label>
                                        </div>
                                        <div class="mt-3">
                                            <label>Age:
                                                <input type="number" class="form-control" name="gameAge" required>
                                            </label>
                                        </div>
                                        <div class="mt-3">
                                            <label class="form-label">Image:
                                                <input class="form-control" type="file" name="gameImageToken">
                                            </label>
                                        </div>
                                        <div class="mt-3">
                                            <label>Description:
                                                <textarea class="form-control" name="gameDescription"></textarea>
                                            </label>
                                        </div>
                                        <div class="mt-3">
                                            <span>Platform:</span>
                                            <div class="form-check" th:each="platform : ${allPlatforms}">
                                                <input class="form-check-input" type="checkbox" name="platform" th:value="${platform.platformId}" th:id="${platform.platformId}">
                                                <label class="form-check-label" th:for="${platform.platformId}" th:text="${platform.platformName}">
                                                </label>
                                            </div>
                                        </div>
                                        <div class="mt-3">
                                            <span>Genre:</span>
                                            <div class="form-check" th:each="genre : ${allGenres}">
                                                <input class="form-check-input" type="checkbox" name="genres" th:value="${genre.genreId}" th:id="${genre.genreId}">
                                                <label class="form-check-label" th:for="${genre.genreId}" th:text="${genre.genreName}">
                                                </label>
                                            </div>
                                        </div>
                                        <div class="mt-3">
                                            <span>Game requirements:</span>
                                            <label class="form-label mt-3">
                                                Operation system:
                                                <input class="form-control" type="text" name="gameRequirementsOS">
                                            </label>
                                            <label class="form-label mt-3">
                                                CPU:
                                                <input class="form-control" type="text" name="gameRequirementsCPU">
                                            </label>
                                            <label class="form-label mt-3">
                                                Memory:
                                                <input class="form-control" type="text" name="gameRequirementsMemory">
                                            </label>
                                            <label class="form-label mt-3">
                                                GPU:
                                                <input class="form-control" type="text" name="gameRequirementsGPU">
                                            </label>
                                            <label class="form-label mt-3">
                                                Storage:
                                                <input class="form-control" type="text" name="gameRequirementsStorage">
                                            </label>
                                        </div>

                                        <div class="mt-3">
                                            <span>Game rating</span>
                                            <label class="form-label mt-3">
                                                Gameplay:
                                                <input class="form-control" type="number" step="0.1" name="gameRatingGameplay">
                                            </label>
                                            <label class="form-label mt-3">
                                                Graphics:
                                                <input class="form-control" type="number" step="0.1" name="gameRatingGraphics">
                                            </label>
                                            <label class="form-label mt-3">
                                                Difficulty:
                                                <input class="form-control" type="number" step="0.1" name="gameRatingDifficulty">
                                            </label>
                                            <label class="form-label mt-3">
                                                Average rating:
                                                <input class="form-control" type="number" step="0.1" name="gameRatingAvg">
                                            </label>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        <button class="btn btn-primary">Add game</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!-- ALL GAMES TABLE -->
                    <table class="table">
                        <thead>
                        <tr>
                            <th scope="col">ID</th>
                            <th scope="col">Name</th>
                            <th scope="col">Age</th>
                            <th scope="col">Platform</th>
                            <th scope="col">Genre</th>
                            <th scope="col">Details</th>
                            <th scope="col">Delete</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="game : ${allGames}">
                            <th scope="row" th:text="${game.gameId}"></th>
                            <td th:text="${game.gameName}"></td>
                            <td th:text="${game.gameAge}"></td>
                            <td><span th:each="platform : ${game.getPlatform()}" th:text="${platform.getPlatformName()} + '/'"></span></td>
                            <td><span th:each="genre : ${game.getGenres()}" th:text="${genre.getGenreName()} + '/'"></span>
                            <td><a class="btn btn-primary" th:href="@{'/detailsGameAdmin/' + ${game.gameId}}">Details</a></td>
                            <td>
                                <button type="button" class="btn btn-danger deleteGameModal" data-bs-toggle="modal" data-bs-target="#deleteGameAdmin"
                                        th:data-id="${game.gameId}">
                                Delete
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <form th:action="@{'/deleteGameAdmin'}" method="post">
                        <div class="modal fade" id="deleteGameAdmin" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Delete Game</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        Are you sure?
                                        <input type="hidden" name="gameId" value="" id="gameId">
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                        <button class="btn btn-danger">Delete Game</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>

                    <script>
                        $(document).on("click", ".deleteGameModal", function () {
                            var gameId = $(this).data("id");
                            $(".modal-body #gameId").val( gameId );
                        });

                        $(document).on("click", ".deleteNewsModal", function () {
                            var newsId = $(this).data("id");
                            $(".modal-body #newsId").val( newsId );
                        });

                        $(document).on("click", ".deleteBlogModal", function () {
                            var blogId = $(this).data("id");
                            $(".modal-body #blogId").val( blogId );
                        });
                    </script>
                </div>
            </div>
        </div>
        <!-- Blogs Collapse -->
        <div class="d-flex">
            <div class="admin-collapse">
                <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#blogsCollapseAdmin" aria-expanded="false" aria-controls="collapseExample">
                    Blogs
                </button>
            </div>
            <div class="collapse admin-collapse__show" id="blogsCollapseAdmin">
                <div class="card card-body">
                    <!-- ALL BLOGS TABLE -->
                    <table class="table">
                        <thead>
                        <tr>
                            <th scope="col">ID</th>
                            <th scope="col">Title</th>
                            <th scope="col">Create date</th>
                            <th scope="col">Update date</th>
                            <th scope="col">Game</th>
                            <th scope="col">Details</th>
                            <th scope="col">Delete</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="blog : ${allBlogs}">
                            <th scope="row" th:text="${blog.blogId}"></th>
                            <td th:text="${blog.blogTitle}"></td>
                            <td th:text="${blog.blogCreateDate}"></td>
                            <td th:text="${blog.blogUpdateDate}"></td>
                            <td th:text="${blog.getGames().gameName}"></td>
                            <td><a class="btn btn-primary" th:href="@{'/detailsBlogAdmin/' + ${blog.blogId}}">Details</a></td>
                            <td>
                                <button type="button" class="btn btn-danger deleteBlogModal" data-bs-toggle="modal" data-bs-target="#deleteBlogAdmin"
                                        th:data-id="${blog.blogId}">
                                    Delete
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <!-- Delete Blog Modal -->
                    <form th:action="@{'/deleteBlogAdmin'}" method="post">
                        <div class="modal fade" id="deleteBlogAdmin" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Delete Blog</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        Are you sure?
                                        <input type="hidden" name="blogId" value="" id="blogId">
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                        <button class="btn btn-danger">Delete Blog</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <!-- ApplicationFormsBlogger Collapse -->
        <div class="d-flex">
            <div class="admin-collapse">
                <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#applicationForBloggerRole" aria-expanded="false" aria-controls="collapseExample">
                    Applications for Blogger Role
                </button>
            </div>
            <div class="collapse admin-collapse__show" id="applicationForBloggerRole">
                <div class="card card-body">
                    <!-- ALL ApplicationFormsBlogger TABLE -->
                    <table class="table">
                        <thead>
                        <tr>
                            <th scope="col">ID</th>
                            <th scope="col">Receipt date</th>
                            <th scope="col">Update date</th>
                            <th scope="col">Status</th>
                            <th scope="col">Author</th>
                            <th scope="col">Details</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="app : ${allApplicationForBloggerRole}">
                            <th scope="row" th:text="${app.applicationFormBloggerId}"></th>
                            <td th:text="${app.applicationFormBloggerReceiptDate}"></td>
                            <td th:text="${app.applicationFormBloggerUpdateDate}"></td>
                            <td th:text="${app.getApplicationBloggerStatus().getApplicationBloggerStatus()}" th:style="'color: ' + ${app.getApplicationBloggerStatus().getApplicationBloggerStatusColor()}"></td>
                            <td th:text="${app.getUsers().getUserFirstName() + ' ' + app.getUsers().getUserSurname()}"></td>
                            <td><a class="btn btn-primary" th:href="@{'/detailsApplicationFormBloggerAdmin/' + ${app.applicationFormBloggerId}}">Details</a></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- Feedback Collapse -->
        <div class="d-flex">
            <div class="admin-collapse">
                <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#feedbackAdmin" aria-expanded="false">
                    Feedback
                </button>
            </div>
            <div class="collapse admin-collapse__show" id="feedbackAdmin">
                <div class="card card-body">
                    <!-- ALL FEEDBACK TABLE -->
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">ID</th>
                                <th scope="col">Name</th>
                                <th scope="col">Email</th>
                                <th scope="col">Subject</th>
                                <th scope="col">Status</th>
                                <th scope="col">Details</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="feedback : ${allFeedback}">
                                <th scope="row" th:text="${feedback.feedbackId}"></th>
                                <td th:text="${feedback.feedbackName}"></td>
                                <td th:text="${feedback.feedbackEmail}"></td>
                                <td th:text="${feedback.feedbackSubject}"></td>
                                <td th:text="${feedback.getFeedbackStatus().getFeedbackStatus()}"
                                    th:style="'color: ' + ${feedback.getFeedbackStatus().feedbackStatusColor}"></td>
                                <td><a class="btn btn-primary" th:href="@{'/detailsFeedbackAdmin/' + ${feedback.feedbackId}}">Details</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- Comments Collapse -->
        <div class="d-flex">
            <div class="admin-collapse">
                <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#commentsAdmin" aria-expanded="false">
                    Comments
                </button>
            </div>
            <div class="collapse admin-collapse__show" id="commentsAdmin">
                <div class="card card-body">
                    <!-- ALL COMMENTS TABLE -->
                    <table class="table">
                        <thead>
                        <tr>
                            <th scope="col">ID</th>
                            <th scope="col">Comment</th>
                            <th scope="col">Author</th>
                            <th scope="col">Create date</th>
                            <th scope="col">Delete</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="comment : ${allComments}">
                            <th scope="row" th:text="${comment.commentId}"></th>
                            <td th:text="${comment.commentText}"></td>
                            <td th:text="${comment.getAuthor().getUserEmail()}"></td>
                            <td th:text="${comment.commentCreateDate}"></td>
                            <td>
                                <button type="button" class="btn btn-danger deleteCommentModal"
                                        th:data-id="${comment.commentId}"
                                        data-bs-toggle="modal"
                                        data-bs-target="#deleteCommentModal">
                                    Delete
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <div class="modal fade" id="deleteCommentModal" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog">
                            <form th:action="@{'/deleteCommentAdmin'}" method="post">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Delete comment</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <input type="hidden" name="commentId" value="" id="commentId">
                                        Do you really want to delete this comment?
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        <button class="btn btn-danger">Delete</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <script>
                        $(document).on("click", ".deleteCommentModal", function () {
                            var commentId = $(this).data("id");
                            $(".modal-body #commentId").val(commentId);
                        });
                    </script>
                </div>
            </div>
        </div>

    </main>

    <!-- Footer section -->
    <footer class="footer-section" th:insert="~{/toInsert/footer.html}">
    </footer>
    <!-- Footer section end -->

    <div th:insert="~{/toInsert/scripts.html}"></div>
</body>
</html>
